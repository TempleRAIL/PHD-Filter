<launch>
	<arg name="moving_type" default="robot0" />
        <arg name="base_frame_id"   default="base" />
        <arg name="global_frame_id" default="/map" />
        <arg name="sensor_type" default="range_bearing"/>

 <group ns="$(arg moving_type)" >
    <node name="sensor_throttle" pkg="phd_sensor" type="$(arg sensor_type)_throttle"
          output="screen" respawn="false">

      <param name="min_time" value="0.1"/>
      <param name="max_time" value="1.0"/>

      <param name="min_angle" value="$eval pi/4)"/>
      <param name="min_step" value="2.0"/>
    </node>

    <node name="laser" pkg="laser_simulator" type="laser_simulator"
          output="screen" respawn="false">
      <param name="frame_id" value="/$(arg moving_type)/$(arg base_frame_id)"/>
      <param name="offset/x" value="0.0"/>
      <param name="offset/y" value="0.0"/>
      <param name="offset/z" value="0.2"/>

      <param name="noise_sd" value="0.003"/>

      <rosparam file="$(find laser_simulator)/models/UTM_30.yaml" command="load"/>
      <rosparam file="$(find laser_simulator)/config/models.yaml" command="load"/>

      <remap from="~map" to="/map"/>
      <remap from="~odom" to="/$(arg moving_type)/gt_odom"/>
      <remap from="~pose_array" to="/pose_array"/>
      <remap from="~scan" to="/$(arg moving_type)/scan" />
    </node>
    
    <node name="goal_to_action" pkg="hfn" type="goal_to_action.py" />

    <node name="navigation" pkg="hfn" type="hfn" respawn="false"
          output="screen" launch-prefix="" >
      <remap from="pose" to="gt_pose"/>
      <remap from="odom" to="gt_odom"/>
      <remap from="map" to="/map"/>

      <param name="base_frame_id" value="/$(arg moving_type)/$(arg base_frame_id)" />
      <param name="map_frame_id" value="$(arg global_frame_id)" />

      <param name="robot_radius" value="0.2" />
      <param name="safety_margin" value="0.1" />

      <param name="v_opt" value="2.0" />
      <param name="w_max" value="5.0" />
      <param name="waypoint_thresh" value="0.2" />
      <param name="waypoint_spacing" value="0.3" />

      <param name="cost_occ_prob" value="0.0" />
      <param name="cost_occ_dist" value="0.5" />
      <param name="max_occ_dist" value="1.0" />
      <param name="lethal_occ_dist" value="0.2" />

      <param name="alpha_thresh" value="2.094" />
      <param name="path_margin" value="0.5" />
      <param name="allow_unknown_path" value="false" />

      <param name="goal_tolerance" value="0.5" />
      <param name="timeout" value="200" />
    </node>

    <node name="waypoints" pkg="hfn" type="way_points1" >
	<remap from="measurements" to="/measurements"/>
	<param name="wp" value="/$(arg moving_type)/move"/> 
	<!--rosparam file="$(find hfn)/points/$(arg moving_type)_waypoints.yaml" command="load" /-->
        <rosparam file="$(find hfn)/points/$(arg moving_type)_waypoints.yaml" command="load" />
    </node>

  </group>
</launch>
